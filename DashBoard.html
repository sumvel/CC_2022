<!DOCTYPE html>
<html>

<head>
    <title>Cricket Carnival</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="./default.css">
    <link rel="stylesheet" href="./w3.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="./data.js"></script>
    <script src="./other_functions.js"></script>
    <script src="./data_processing.js"></script>
</head>

<body class="w3-light-grey">

    <!-- Top container -->
    <div class="w3-bar w3-top slb-blue w3-large" style="z-index:4">
        <button class="w3-bar-item w3-button w3-hide-large w3-hover-none w3-hover-text-light-grey" onclick="w3_open();"><i class="fa fa-bars"></i>&nbsp;Menu</button>
        <span class="w3-bar-item w3-left">IPL 2022</span>
        <span class="w3-bar-item w3-right">Cricket Carnival 2022</span>
    </div>
    <!-- Sidebar/menu -->
    <nav class="w3-sidebar w3-collapse w3-white w3-animate-left" style="z-index:3;width:300px;" id="mySidebar"><br>
        <div class="w3-container w3-row">
            <div class="w3-col s4">
                <img src="./avatar2.png" class="w3-circle w3-margin-right" style="width:46px">
            </div>
            <div class="w3-col s8 w3-bar">
                <span><strong>Welcome</strong></span><br>
                <!-- <a href="#" class="w3-bar-item w3-button"><i class="fa fa-envelope"></i></a>
                <a href="#" class="w3-bar-item w3-button"><i class="fa fa-user"></i></a>
                <a href="#" class="w3-bar-item w3-button"><i class="fa fa-cog"></i></a> -->
            </div>
        </div>
        <hr>
        <div class="w3-container">
            <h5>Dashboard</h5>
        </div>
        <div class="w3-bar-block">
            <a href="#" class="w3-bar-item w3-button w3-padding-16 w3-hide-large w3-dark-grey w3-hover-black" onclick="w3_close()" title="close menu"><i class="fa fa-remove fa-fw"></i>&nbsp;Close Menu</a>
            <a href="#" class="w3-bar-item w3-button w3-padding w3-blue"><i class="fa fa-users fa-fw"></i>&nbsp;Overview</a>
            <!-- <a href="#" class="w3-bar-item w3-button w3-padding"><i class="fa fa-bank fa-fw"></i>&nbsp;General</a> -->
            <a href="https://sumvel.github.io/CC_2022/" class="w3-bar-item w3-button w3-padding" target="_new"><i class="fa fa fa-line-chart fa-fw"></i>&nbsp;Score Card</a>
            <a href="rules.html" class="w3-bar-item w3-button w3-padding"><i class="fa fa-book fa-fw"></i>&nbsp;Rules</a>
            <a href="about.html" class="w3-bar-item w3-button w3-padding"><i class="fa fa-info fa-fw"></i>&nbsp;About</a><br><br>
        </div>
    </nav>

    <!-- Overlay effect when opening sidebar on small screens -->
    <div class="w3-overlay w3-hide-large w3-animate-opacity" onclick="w3_close()" style="cursor:pointer" title="close side menu" id="myOverlay"></div>

    <!-- !PAGE CONTENT! -->
    <div class="w3-main" style="margin-left:300px;margin-top:43px;">

        <!-- Header -->
        <header class="w3-container" style="padding-top:22px">
            <div class="img-container">
                <img class="w3-image" src="./stadium_wide.png" alt="London" style="width:100%;min-height:200px;max-height:300px;">
                <div class="centered-left">
                    <div id="img_centered_teamA"><img src="csk.png"></div>
                </div>
                <div class="centered">
                    <strong id="img_centered_text">CRICKET CARNIVAL</strong>
                    <!-- <p style="max-height: 300px;" id="img_centered_text"><strong>CRICKET CARNIVAL</strong></p> -->
                </div>
                <div class="centered-right">
                    <div id="img_centered_teamB"><img src="kkr.png"></div>
                </div>
            </div>
            <h5><b><i class="fa fa-dashboard"></i> Dashboard</b></h5>
        </header>

        <!-- First Team Row -->
        <div class="w3-row-padding w3-margin-bottom">
            <!-- <div class="w3-quarter">
                <canvas id="myChart" style="width:100%;max-width:500px"></canvas>
            </div> -->
            <div class="w3-quarter">
                <div id="myPlot_big_pie_1" style="width:100%;max-width:500px"></div>
            </div>
            <div class="w3-quarter">
                <!-- <div id="myPlot_big_pie_r2" style="width:100%;max-width:500px"></div> -->
                <div id="choose_round"></div>
                <br>
                <div class="w3-half">
                    <div class="w3-container ipl-csk w3-padding-16" id="choose_teamA_container">
                        <div class="w3-left"><i class="fa fa-users w3-xxxlarge"></i></div>
                        <div class="w3-right" id="choose_teamA_count">0</div>
                        <div class="w3-clear"></div>
                        <div id="choose_teamA">TEAM A</div>
                    </div>
                </div>
                <div class="w3-half">
                    <div class="w3-container ipl-kkr w3-padding-16" id="choose_teamB_container">
                        <div class="w3-left"><i class="fa fa-users w3-xxxlarge"></i></div>
                        <div class="w3-right" id="choose_teamB_count">0</div>
                        <div class="w3-clear"></div>
                        <div id="choose_teamB">TEAM B</div>
                    </div>
                </div>
                <div class="w3-row-padding w3-margin-bottom" style="height:300px;overflow: auto;">
                    <h5>Individual Top Rankings</h5>
                    <div class="w3-container" id="top_player_ranks"></div>
                </div>
                <br>
                <!-- <div class="w3-quarter" id="myPlot_big_pie_2" style="width:100%;max-width:500px;"></div> -->
            </div>
            <div class="w3-quarter">
                <div id="myPlot_hor_bar_1" style="width:100%;max-width:500px"></div>
            </div>
            <div class="w3-quarter">
                <div id="myPlot_hor_bar_2" style="width:100%;max-width:500px"></div>
            </div>
        </div>
        
        <div class="w3-panel">
            <div class="w3-row-padding" style="margin:0 -16px">
                <!-- <div class="w3-third">
                    <h5>Cricket Carnival</h5>
                    <img src="./IPL_Trophy.png" style="width:100%;" alt="IPL Tropthy">
                </div> -->
                
                <div class="w3-theme-d2">
                    <h5>Score Card</h5>
                    <iframe src="https://sumvel.github.io/CC_2022/" title="MainBoard" style="width:100%;height:600px;border: 0;"></iframe>
                </div>
            </div>
        </div>

        <br>
        <!-- Footer -->
        <footer class="w3-container w3-padding-5 w3-dark-grey w3-center">
            <p>The best way to predict the future is to create it</p>
        </footer>
        <!-- End page content -->
    </div>

    <script>
        // Get the Sidebar
        var mySidebar = document.getElementById("mySidebar");
        // Get the DIV with overlay effect
        var overlayBg = document.getElementById("myOverlay");
        // Toggle between showing and hiding the sidebar, and add overlay effect
        function w3_open() {
            if (mySidebar.style.display === 'block') {
                mySidebar.style.display = 'none';
                overlayBg.style.display = "none";
            } else {
                mySidebar.style.display = 'block';
                overlayBg.style.display = "block";
            }
        }

        // Close the sidebar with the close button
        function w3_close() {
            mySidebar.style.display = "none";
            overlayBg.style.display = "none";
        }

        // var steam_st = new Array("WPRS", "WEC", "Elec", "RP", "RoS");
        // var teams_list_st = new Array("CSK", "DC", "GT", "KKR", "LSG", "MI", "PBKS", "RCB", "RR", "SRH");

        var TRound1_teams = steam_st; // ["WC", "Electrical", "RP", "M&S", "TechCom", "WPRS", "A2 & CST", "Others"];
        var TRound2_teams = steam_st; // not yet released
        var TRound3_teams = steam_st; // not yet released
        var TRound4_teams = steam_st; // not yet released
        var TRound1_count = [35, 33, 30, 27, 28] //[24, 18, 12, 12, 6, 23, 3, 7];
        var TRound2_count = [0, 0, 0, 0, 0]; //not yet released
        var TRound3_count = [0, 0, 0, 0, 0]; //not yet released
        var TRound4_count = [0, 0, 0, 0, 0]; //not yet released

        var IPLcolorsObj = {CSK:"#FFFF3C", DC:"#00008B", GT:"#4752a1", KKR:"#2E0854", LSG:"#7fd2d8", MI:"#004BA0", PBKS:"#DCDDDF", RCB:"#EC1C24", RR:"#CBA92B", SRH:"#FF822A"};
        var IPLcolorsArr = ["#FFFF3C", "#00008B", "#4752a1", "#2E0854", "#7fd2d8", "#004BA0", "#DCDDDF", "#EC1C24", "#CBA92B", "#FF822A"];
        var ipl_color_class = ["ipl-csk", "ipl-dc", "ipl-gt", "ipl-kkr", "ipl-lsg", "ipl-mi", "ipl-pbks", "ipl-rcb", "ipl-rr", "ipl-srh"];

        // var xArray = [24, 18, 12, 12, 6, 23, 3, 7];
        // var yArray = ["WC", "Electrical", "RP", "M&S", "TechCom", "WPRS", "A2 & CST", "Others"];
        function showBigPieChart(xArray, yArray, ID, chartTile, chartLegend) {
            if (!xArray || xArray == null) {xArray = TRound1_teams;}
            if (!yArray || yArray == null) {yArray = TRound1_count;}
            if (!chartLegend || chartLegend == null) {chartLegend = false;}
            
            var layout = {
                title:chartTile,
                showlegend: chartLegend
            };

            var data = [{
                labels:xArray, values:yArray, hole: .4, type:"pie",
                textinfo: "label+percent",
                insidetextorientation: "radial"
            }];
            Plotly.newPlot(ID, data, layout);
        }

        function showHorBarChart(xArray, yArray, ID, chartTile, barColor) {
            if (!xArray || xArray == null) {
                xArray = TRound1_count;
            }
            if (!yArray || yArray == null) {
                yArray = TRound1_teams;
            }
            if (!chartTile) { chartTile="undefined"; }
            if (!barColor) { barColor="rgba(255,0,0,0.6)"; }
            var data = [{
                x:xArray,
                y:yArray,
                type:"bar",
                orientation:"h",
                marker: {color:barColor}
            }];

            var layout = {
                title:chartTile
            };

            Plotly.newPlot(ID, data, layout);
        }

        function showVerBarChart(xArray, yArray, ID, chartTile, barColor) {
            if (!xArray || xArray == null) {
                xArray = TRound1_teams;
            }
            if (!yArray || yArray == null) {
                yArray = TRound1_count;
            }
            if (!chartTile) { chartTile="undefined"; }
            if (!barColor) { barColor="rgba(255,0,0,0.6)"; }
            var data = [{
                x:xArray,
                y:yArray,
                type:"bar",
                marker: {color:barColor}
            }];

            var layout = {title:chartTile};
            Plotly.newPlot(ID, data, layout);
        }

        showBigPieChart(TRound1_teams, TRound1_count, "myPlot_big_pie_1", "Team Entries for Round 1", false);
        // showBigPieChart([team1[0], team2[0]], null, "myPlot_big_pie_2", "Team Percentage");

        showHorBarChart([10, 15, 20, 25, 30, 35, 40, 45], null, "myPlot_hor_bar_1", "Team Entries for CSK", "rgba(255,0,0,0.6)");
        showHorBarChart([45, 40, 35, 30, 25, 20, 15, 10], null, "myPlot_hor_bar_2", "Team Entries for KKR", "rgba(0, 102, 255, 0.6)");
        // showVerBarChart("myPlot_ver_bar_1", "Team Entries for Team B");

        function calcTeamSupport() {
            var mat1 = [];

            for (let i = 0; i < picks.length; i++) {
                const e = picks[i].pick;
                mat1[i] = e[i];
                console.log(i + " : " + e[0]);
            }
            console.log(mat1);
        }

        function update_match_info(){
            /*===========================*\
                Home Default values
            \*===========================*/
            var matid = document.getElementById("choose_match_id");
            if (matid.options[matid.selectedIndex].value == "default") {
                p = match_result.length;
                if (p >= matches)
                    p = matches - 1;
            } else {
                var matnum = matid.options[matid.selectedIndex].value;
                p = parseInt(matnum) - 1;
            }
            document.getElementById("choose_teamA").innerHTML = teams_list_st[teams_list_st.indexOf(team1[p])];
            document.getElementById("choose_teamB").innerHTML = teams_list_st[teams_list_st.indexOf(team2[p])];

            document.getElementById("choose_teamA_count").innerHTML = team1_bets[p];
            document.getElementById("choose_teamB_count").innerHTML = team2_bets[p];

            document.getElementById("img_centered_teamA").innerHTML = "<img src='" + team1[p].toLowerCase() + ".png'>";
            document.getElementById("img_centered_teamB").innerHTML = "<img src='" + team2[p].toLowerCase() + ".png'>";
            
            document.getElementById("choose_teamA_container").className = "w3-container w3-padding-16 " + ipl_color_class[teams_list_st.indexOf(team1[p])];
            document.getElementById("choose_teamB_container").className = "w3-container w3-padding-16 " + ipl_color_class[teams_list_st.indexOf(team2[p])];

            document.getElementById("img_centered_text").setAttribute("style", "color:" + IPLcolorsArr[teams_list_st.indexOf(team1[p])] + ";");

            showHorBarChart([17, 8, 12, 12, 6, 18, 2, 7], null, "myPlot_hor_bar_1", "Team Entries for " + team1[p], "rgba(255,0,0,0.6)");
            showHorBarChart([7, 2, 2, 5, 0, 5, 1, 0], null, "myPlot_hor_bar_2", "Team Entries for " + team2[p], "rgba(0, 102, 255, 0.6)");
        };

        /*=================================*\
				Home Match Selection
		\*=================================*/
		var divChoose = "<label for='choose_match_id'>Choose Match:</label><select id = 'choose_match_id' onchange='update_match_info()'>";
		divChoose = divChoose + "<option value='default'>Select Match</option>";
		for (i = 0; i < matches; i++){
			divChoose = divChoose + "<option value='" + (i + 1) + "'>Match " + (i + 1) + " : "+ team1[i] + " vs " + team2[i] + "</option>";
        }
		divChoose = divChoose + "</select>";
		document.getElementById('choose_round').innerHTML = divChoose;

        /*=======================*\
                Home Top Ranks
        \*=======================*/
        divran ="<table class='w3-table w3-striped w3-bordered w3-border w3-hoverable w3-white'><tr bgcolor='00FFE0'><th align='center'>&nbsp;</th><th align='center'>Rank</th><th align='center'>Player</th><th align='center'>Score</th></tr>";
        for(j=0; j<10 ;j++) {
            if(j%2 != 0)
                divran = divran + "<tr bgcolor='#D8D8D8'>";
            else
                divran = divran + "<tr bgcolor='#F8F8F8'>";
            divran = divran + "<td><i class='fa fa-user w3-text-red w3-large'></i></td><td align ='center'>";
            if(j!=0 && player_score_ranks[j] == player_score_ranks[j-1])
                divran = divran +"&nbsp";
            else
                divran = divran + player_ranks_ranks[j];
        
            divran = divran + "</td><td>" + player_list_ranks[j]+"</td><td align='center'>" + player_score_ranks[j] + "</td></tr>";  // .toUpperCase() 
        }
        divran = divran +"</table>";
        document.getElementById('top_player_ranks').innerHTML= divran;

        update_match_info();
    </script>

</body>

</html>
